<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HighPipe EKS ì•„í‚¤í…ì²˜ ë‹¤ì´ì–´ê·¸ë¨</title>
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js"></script>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            margin: 0;
            padding: 20px;
            background: #f8fafc;
            color: #334155;
            line-height: 1.6;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            margin: 0;
            font-size: 2.5rem;
            font-weight: 700;
        }

        .header p {
            margin: 10px 0 0 0;
            opacity: 0.9;
            font-size: 1.1rem;
        }

        .nav {
            background: #f1f5f9;
            padding: 20px 30px;
            border-bottom: 1px solid #e2e8f0;
        }

        .nav-buttons {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .nav-btn {
            padding: 10px 20px;
            background: #3b82f6;
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.2s;
        }

        .nav-btn:hover {
            background: #2563eb;
            transform: translateY(-1px);
        }

        .nav-btn.active {
            background: #1d4ed8;
            box-shadow: 0 4px 12px rgba(59, 130, 246, 0.4);
        }

        .zoom-controls {
            position: absolute;
            top: 10px;
            right: 10px;
            display: flex;
            gap: 5px;
            z-index: 10;
        }

        .zoom-btn {
            background: #6366f1;
            color: white;
            border: none;
            border-radius: 4px;
            padding: 8px 12px;
            cursor: pointer;
            font-size: 14px;
            font-weight: bold;
        }

        .zoom-btn:hover {
            background: #4f46e5;
        }

        .diagram-wrapper {
            position: relative;
            transform-origin: top left;
            transition: transform 0.3s ease;
        }

        .content {
            padding: 30px;
        }

        .diagram-section {
            display: none;
            animation: fadeIn 0.3s ease-in;
        }

        .diagram-section.active {
            display: block;
        }

        .diagram-section h2 {
            color: #1e293b;
            font-size: 1.8rem;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #e2e8f0;
        }

        .diagram-container {
            background: #ffffff;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
            overflow-x: auto;
            min-height: 600px;
        }

        .mermaid {
            text-align: center;
            min-height: 500px;
        }

        .mermaid svg {
            max-width: none !important;
            width: auto !important;
            height: auto !important;
            min-width: 1200px;
            font-size: 14px !important;
        }

        .description {
            background: #f8fafc;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            border-left: 4px solid #3b82f6;
        }

        .description h3 {
            margin-top: 0;
            color: #1e293b;
        }

        .features {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .feature {
            background: #f1f5f9;
            padding: 15px;
            border-radius: 6px;
            border-left: 3px solid #10b981;
        }

        .feature h4 {
            margin: 0 0 8px 0;
            color: #059669;
            font-size: 14px;
            font-weight: 600;
        }

        .feature p {
            margin: 0;
            font-size: 13px;
            color: #64748b;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .loading {
            text-align: center;
            padding: 40px;
            color: #64748b;
        }

        .spinner {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid #f3f3f3;
            border-top: 3px solid #3b82f6;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-right: 10px;
        }

        @keyframes spin {
            0% {
                transform: rotate(0deg);
            }

            100% {
                transform: rotate(360deg);
            }
        }

        @media (max-width: 768px) {
            body {
                padding: 10px;
            }

            .header {
                padding: 20px;
            }

            .header h1 {
                font-size: 2rem;
            }

            .nav {
                padding: 15px 20px;
            }

            .content {
                padding: 20px;
            }

            .nav-buttons {
                justify-content: center;
            }

            .nav-btn {
                font-size: 12px;
                padding: 8px 16px;
            }
        }
    </style>
</head>

<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ—ï¸ HighPipe EKS ì•„í‚¤í…ì²˜</h1>
            <p>Kubernetes ê¸°ë°˜ ë°ì´í„° íŒŒì´í”„ë¼ì¸ ìë™í™” ì‹œìŠ¤í…œ</p>
        </div>

        <div class="nav">
            <div class="nav-buttons">
                <button class="nav-btn active" onclick="showDiagram('system')">ğŸ¢ ì „ì²´ ì‹œìŠ¤í…œ</button>
                <button class="nav-btn" onclick="showDiagram('nodes')">ğŸ–¥ï¸ ë…¸ë“œ ê·¸ë£¹</button>
                <button class="nav-btn" onclick="showDiagram('dataflow')">ğŸ”„ ë°ì´í„° í”Œë¡œìš°</button>
                <button class="nav-btn" onclick="showDiagram('security')">ğŸ›¡ï¸ ë„¤íŠ¸ì›Œí¬ ë³´ì•ˆ</button>
                <button class="nav-btn" onclick="showDiagram('scaling')">ğŸ“ˆ Auto Scaling</button>
            </div>
        </div>

        <div class="content">
            <!-- ì „ì²´ ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜ -->
            <div id="system" class="diagram-section active">
                <h2>ğŸ¢ ì „ì²´ ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜</h2>
                <div class="description">
                    <h3>ê°œìš”</h3>
                    <p>EKS í´ëŸ¬ìŠ¤í„°ë¥¼ ì¤‘ì‹¬ìœ¼ë¡œ í•œ ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ ì•„í‚¤í…ì²˜ì…ë‹ˆë‹¤. ë„¤ì„ìŠ¤í˜ì´ìŠ¤ë³„ë¡œ ì„œë¹„ìŠ¤ë¥¼ ë¶„ë¦¬í•˜ì—¬ ê´€ë¦¬í•˜ë©°, AWS ê´€ë¦¬í˜• ì„œë¹„ìŠ¤ì™€ ì—°ë™ë©ë‹ˆë‹¤.</p>
                </div>
                <div class="features">
                    <div class="feature">
                        <h4>ğŸ“± Web Tier</h4>
                        <p>React í”„ë¡ íŠ¸ì—”ë“œ, Nginx ë¡œë“œë°¸ëŸ°ì„œ, Ingress Controller</p>
                    </div>
                    <div class="feature">
                        <h4>ğŸ”§ App Tier</h4>
                        <p>Backend API, WebSocket ì„œë²„, Airflow í´ëŸ¬ìŠ¤í„°</p>
                    </div>
                    <div class="feature">
                        <h4>ğŸ”„ Pipeline Tier</h4>
                        <p>í¬ë¡¤ë§ ì„œë²„, LLM ë¶„ì„ ì„œë²„, Spark í´ëŸ¬ìŠ¤í„°</p>
                    </div>
                    <div class="feature">
                        <h4>ğŸ’¾ Data Tier</h4>
                        <p>Kafka í´ëŸ¬ìŠ¤í„°, Redis, PostgreSQL í”„ë¡ì‹œ</p>
                    </div>
                </div>
                <div class="diagram-container">
                    <div class="mermaid">
                        graph TB
                        %% External Components
                        User[ğŸ‘¤ ì‚¬ìš©ì]
                        Internet[ğŸŒ ì¸í„°ë„·]

                        %% AWS Services
                        subgraph AWS["â˜ï¸ AWS Cloud"]
                        subgraph VPC["ğŸ¢ VPC"]
                        subgraph PublicSubnet["ğŸŒ Public Subnet"]
                        ALB[âš–ï¸ Application Load Balancer]
                        NAT[ğŸšª NAT Gateway]
                        end

                        subgraph PrivateSubnet["ğŸ”’ Private Subnet"]
                        subgraph EKS["â˜¸ï¸ EKS Cluster"]

                        %% Web Tier Namespace
                        subgraph WebTier["ğŸ“± web-tier namespace"]
                        Frontend[âš›ï¸ React Frontend<br />Pods: 3]
                        Nginx[ğŸ”„ Nginx LoadBalancer<br />Pods: 2]
                        Ingress[ğŸšª Ingress Controller]
                        end

                        %% Application Tier Namespace
                        subgraph AppTier["ğŸ”§ app-tier namespace"]
                        BackendAPI[ğŸ–¥ï¸ Backend API<br />Node.js<br />Pods: 3-20 HPA]
                        WebSocket[ğŸ”Œ WebSocket Server<br />Pods: 2-10 HPA]

                        subgraph AirflowCluster["ğŸŒŠ Airflow Cluster"]
                        AirflowScheduler[ğŸ“… Scheduler<br />Pod: 1]
                        AirflowWebserver[ğŸŒ Webserver<br />Pods: 2]
                        AirflowWorker[ğŸ‘· Workers<br />Pods: 2-10 HPA]
                        end
                        end

                        %% Pipeline Tier Namespace
                        subgraph PipelineTier["ğŸ”„ pipeline-tier namespace"]
                        CrawlingServer[ğŸ•·ï¸ Crawling Server<br />FastAPI + Selenium<br />Pods: 2-8 HPA]
                        AnalysisServer[ğŸ§  LLM Analysis Server<br />FastAPI + GPU<br />Pods: 1-5 HPA]
                        SparkCluster[âš¡ Spark Cluster<br />Driver: 1 Executors: 2-10]
                        end

                        %% Data Tier Namespace
                        subgraph DataTier["ğŸ’¾ data-tier namespace"]
                        subgraph KafkaCluster["ğŸ“¨ Kafka Cluster"]
                        Kafka1[ğŸ“¨ Kafka Broker 1]
                        Kafka2[ğŸ“¨ Kafka Broker 2]
                        Kafka3[ğŸ“¨ Kafka Broker 3]
                        Zookeeper[ğŸ˜ Zookeeper<br />Pods: 3]
                        end

                        Redis[ğŸ”´ Redis Cluster<br />Master: 1 Slaves: 2]
                        PostgresProxy[ğŸ˜ PostgreSQL Proxy<br />Connection Pooling]
                        end

                        %% Monitoring Namespace
                        subgraph Monitoring["ğŸ“Š monitoring namespace"]
                        Prometheus[ğŸ“ˆ Prometheus<br />Pod: 1]
                        Grafana[ğŸ“Š Grafana<br />Pod: 1]
                        AlertManager[ğŸš¨ AlertManager<br />Pod: 1]
                        end
                        end
                        end
                        end

                        %% Managed AWS Services
                        subgraph ManagedServices["ğŸ› ï¸ AWS Managed Services"]
                        RDS[ğŸ—„ï¸ RDS PostgreSQL<br />Multi-AZ]
                        S3[ğŸª£ S3 Data Lake<br />Raw Data Storage]
                        Redshift[ğŸ­ Redshift<br />Data Warehouse]
                        ECR[ğŸ“¦ ECR<br />Container Registry]
                        SecretsManager[ğŸ” Secrets Manager]
                        CloudWatch[ğŸ“Š CloudWatch Logs]
                        end
                        end

                        %% Connections
                        User --> Internet
                        Internet --> ALB
                        ALB --> Ingress
                        Ingress --> Frontend
                        Ingress --> BackendAPI
                        Ingress --> AirflowWebserver

                        Frontend --> BackendAPI
                        BackendAPI --> WebSocket
                        BackendAPI --> Redis
                        BackendAPI --> PostgresProxy
                        BackendAPI --> Kafka1

                        AirflowScheduler --> AirflowWorker
                        AirflowWorker --> CrawlingServer
                        AirflowWorker --> AnalysisServer
                        AirflowWorker --> SparkCluster

                        CrawlingServer --> Kafka2
                        AnalysisServer --> Kafka3
                        SparkCluster --> S3
                        SparkCluster --> Redshift

                        Kafka1 --> Zookeeper
                        Kafka2 --> Zookeeper
                        Kafka3 --> Zookeeper

                        PostgresProxy --> RDS

                        %% Monitoring connections
                        Prometheus --> BackendAPI
                        Prometheus --> Kafka1
                        Prometheus --> Redis
                        Grafana --> Prometheus
                        AlertManager --> Prometheus

                        %% External connections
                        BackendAPI --> SecretsManager
                        CrawlingServer --> S3
                        AnalysisServer --> S3

                        %% Logging
                        BackendAPI --> CloudWatch
                        CrawlingServer --> CloudWatch
                        AnalysisServer --> CloudWatch

                        %% Styling
                        classDef aws fill:#FF9900,stroke:#232F3E,stroke-width:2px,color:#fff
                        classDef k8s fill:#326CE5,stroke:#fff,stroke-width:2px,color:#fff
                        classDef app fill:#4CAF50,stroke:#fff,stroke-width:2px,color:#fff
                        classDef data fill:#2196F3,stroke:#fff,stroke-width:2px,color:#fff
                        classDef monitor fill:#FF5722,stroke:#fff,stroke-width:2px,color:#fff

                        class AWS,ManagedServices aws
                        class EKS,WebTier,AppTier,PipelineTier,DataTier k8s
                        class Frontend,BackendAPI,WebSocket,CrawlingServer,AnalysisServer app
                        class KafkaCluster,Redis,PostgresProxy,RDS,S3,Redshift data
                        class Monitoring,Prometheus,Grafana,AlertManager monitor
                    </div>
                </div>
            </div>

            <!-- ë…¸ë“œ ê·¸ë£¹ êµ¬ì„± -->
            <div id="nodes" class="diagram-section">
                <h2>ğŸ–¥ï¸ ë…¸ë“œ ê·¸ë£¹ êµ¬ì„±</h2>
                <div class="description">
                    <h3>ë…¸ë“œ ê·¸ë£¹ ì „ëµ</h3>
                    <p>ì›Œí¬ë¡œë“œ íŠ¹ì„±ì— ë”°ë¼ 4ê°œì˜ ë…¸ë“œ ê·¸ë£¹ìœ¼ë¡œ ë¶„ë¦¬í•˜ì—¬ ë¹„ìš© íš¨ìœ¨ì„±ê³¼ ì„±ëŠ¥ì„ ìµœì í™”í•©ë‹ˆë‹¤.</p>
                </div>
                <div class="features">
                    <div class="feature">
                        <h4>ğŸ’» General Node Group</h4>
                        <p>ì¼ë°˜ì ì¸ ì›¹ ì„œë¹„ìŠ¤ ì›Œí¬ë¡œë“œ (m5.large/xlarge)</p>
                    </div>
                    <div class="feature">
                        <h4>ğŸ® GPU Node Group</h4>
                        <p>LLM ë¶„ì„ ì „ìš© GPU ì¸ìŠ¤í„´ìŠ¤ (g4dn.xlarge/2xlarge)</p>
                    </div>
                    <div class="feature">
                        <h4>ğŸ’¾ Data Node Group</h4>
                        <p>ë©”ëª¨ë¦¬ ì§‘ì•½ì  ë°ì´í„° ì²˜ë¦¬ (r5.large/xlarge)</p>
                    </div>
                    <div class="feature">
                        <h4>ğŸ’° Spot Node Group</h4>
                        <p>ë°°ì¹˜ ì²˜ë¦¬ìš© ë¹„ìš© ì ˆì•½ ì¸ìŠ¤í„´ìŠ¤</p>
                    </div>
                </div>
                <div class="diagram-container">
                    <div class="mermaid">
                        graph TB
                        subgraph EKSCluster["â˜¸ï¸ EKS Cluster"]
                        subgraph GeneralNodeGroup["ğŸ–¥ï¸ General Node Group"]
                        GeneralNode1[ğŸ’» m5.large<br />General Workload<br />2-4 vCPU 8-16GB RAM]
                        GeneralNode2[ğŸ’» m5.xlarge<br />General Workload<br />4 vCPU 16GB RAM]
                        GeneralNode3[ğŸ’» m5.large<br />General Workload<br />2-4 vCPU 8-16GB RAM]
                        end

                        subgraph GPUNodeGroup["ğŸ® GPU Node Group"]
                        GPUNode1[ğŸ® g4dn.xlarge<br />LLM Analysis<br />4 vCPU 16GB RAM<br />1x NVIDIA T4]
                        GPUNode2[ğŸ® g4dn.2xlarge<br />LLM Analysis<br />8 vCPU 32GB RAM<br />1x NVIDIA T4]
                        end

                        subgraph DataNodeGroup["ğŸ’¾ Data Processing Node Group"]
                        DataNode1[ğŸ’¾ r5.large<br />Memory Intensive<br />2 vCPU 16GB RAM]
                        DataNode2[ğŸ’¾ r5.xlarge<br />Memory Intensive<br />4 vCPU 32GB RAM]
                        end

                        subgraph SpotNodeGroup["ğŸ’° Spot Node Group"]
                        SpotNode1[ğŸ’° m5.large Spot<br />Batch Processing<br />2-4 vCPU 8-16GB RAM]
                        SpotNode2[ğŸ’° c5.xlarge Spot<br />CPU Intensive<br />4 vCPU 8GB RAM]
                        end
                        end

                        %% Workload placement
                        GeneralNode1 --> Frontend
                        GeneralNode1 --> BackendAPI
                        GeneralNode2 --> WebSocket
                        GeneralNode2 --> AirflowWebserver
                        GeneralNode3 --> Nginx
                        GeneralNode3 --> Ingress

                        GPUNode1 --> AnalysisServer
                        GPUNode2 --> MLTraining[ğŸ¤– ML Model Training]

                        DataNode1 --> Kafka
                        DataNode1 --> Redis
                        DataNode2 --> SparkDriver[âš¡ Spark Driver]

                        SpotNode1 --> CrawlingServer
                        SpotNode1 --> SparkExecutor[âš¡ Spark Executors]
                        SpotNode2 --> BatchJobs[ğŸ“¦ Batch Processing Jobs]

                        classDef general fill:#4CAF50,stroke:#fff,stroke-width:2px,color:#fff
                        classDef gpu fill:#FF5722,stroke:#fff,stroke-width:2px,color:#fff
                        classDef data fill:#2196F3,stroke:#fff,stroke-width:2px,color:#fff
                        classDef spot fill:#FF9800,stroke:#fff,stroke-width:2px,color:#fff

                        class GeneralNode1,GeneralNode2,GeneralNode3 general
                        class GPUNode1,GPUNode2 gpu
                        class DataNode1,DataNode2 data
                        class SpotNode1,SpotNode2 spot
                    </div>
                </div>
            </div>

            <!-- ë°ì´í„° í”Œë¡œìš° -->
            <div id="dataflow" class="diagram-section">
                <h2>ğŸ”„ ë°ì´í„° í”Œë¡œìš°</h2>
                <div class="description">
                    <h3>ì‹¤ì‹œê°„ ë°ì´í„° ì²˜ë¦¬ íë¦„</h3>
                    <p>ì‚¬ìš©ì ìš”ì²­ë¶€í„° ë¶„ì„ ê²°ê³¼ ë°˜í™˜ê¹Œì§€ì˜ ì „ì²´ ë°ì´í„° í”Œë¡œìš°ë¥¼ ë³´ì—¬ì¤ë‹ˆë‹¤. Kafkaì™€ WebSocketì„ í†µí•œ ì‹¤ì‹œê°„ ì²˜ë¦¬ê°€ í•µì‹¬ì…ë‹ˆë‹¤.</p>
                </div>
                <div class="features">
                    <div class="feature">
                        <h4>ğŸ“¨ ë¹„ë™ê¸° ë©”ì‹œì§•</h4>
                        <p>Kafkaë¥¼ í†µí•œ ëŠìŠ¨í•œ ê²°í•©ê³¼ í™•ì¥ì„± í™•ë³´</p>
                    </div>
                    <div class="feature">
                        <h4>ğŸ”Œ ì‹¤ì‹œê°„ í†µì‹ </h4>
                        <p>WebSocketìœ¼ë¡œ ì§„í–‰ ìƒíƒœ ì‹¤ì‹œê°„ ì—…ë°ì´íŠ¸</p>
                    </div>
                    <div class="feature">
                        <h4>ğŸ”´ ìºì‹± ì „ëµ</h4>
                        <p>Redisë¥¼ í†µí•œ ë¹ ë¥¸ ë°ì´í„° ì ‘ê·¼</p>
                    </div>
                    <div class="feature">
                        <h4>ğŸŒŠ ì›Œí¬í”Œë¡œìš° ê´€ë¦¬</h4>
                        <p>Airflow DAG ê¸°ë°˜ ì‘ì—… ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´ì…˜</p>
                    </div>
                </div>
                <div class="diagram-container">
                    <div class="mermaid">
                        sequenceDiagram
                        participant User as ğŸ‘¤ ì‚¬ìš©ì
                        participant Frontend as âš›ï¸ Frontend
                        participant API as ğŸ–¥ï¸ Backend API
                        participant WS as ğŸ”Œ WebSocket
                        participant Kafka as ğŸ“¨ Kafka
                        participant Airflow as ğŸŒŠ Airflow
                        participant Crawler as ğŸ•·ï¸ Crawler
                        participant Analysis as ğŸ§  Analysis
                        participant DB as ğŸ—„ï¸ Database
                        participant Cache as ğŸ”´ Redis

                        User->>Frontend: ìƒí’ˆ ë¶„ì„ ìš”ì²­
                        Frontend->>API: POST /api/analysis/start
                        API->>Kafka: ë¶„ì„ ìš”ì²­ ë©”ì‹œì§€ ë°œí–‰
                        API->>Cache: ìš”ì²­ ìƒíƒœ ìºì‹±
                        API-->>Frontend: ë¶„ì„ ID ë°˜í™˜

                        Frontend->>WS: WebSocket ì—°ê²° (ë¶„ì„ ID)

                        Kafka->>Airflow: ë©”ì‹œì§€ ìˆ˜ì‹  ë° DAG íŠ¸ë¦¬ê±°
                        Airflow->>Crawler: í¬ë¡¤ë§ ì‘ì—… ì‹œì‘

                        loop í¬ë¡¤ë§ ì§„í–‰
                        Crawler->>Kafka: ì§„í–‰ ìƒíƒœ ì—…ë°ì´íŠ¸
                        Kafka->>API: ìƒíƒœ ë©”ì‹œì§€ ìˆ˜ì‹ 
                        API->>WS: ì‹¤ì‹œê°„ ìƒíƒœ ì „ì†¡
                        WS-->>Frontend: ì§„í–‰ë¥  ì—…ë°ì´íŠ¸
                        end

                        Crawler->>Kafka: ìˆ˜ì§‘ëœ ë¦¬ë·° ë°ì´í„°
                        Kafka->>Analysis: ë¶„ì„ ì‘ì—… ì‹œì‘

                        loop ë¶„ì„ ì§„í–‰
                        Analysis->>Kafka: ë¶„ì„ ì§„í–‰ ìƒíƒœ
                        Kafka->>API: ìƒíƒœ ë©”ì‹œì§€ ìˆ˜ì‹ 
                        API->>WS: ì‹¤ì‹œê°„ ìƒíƒœ ì „ì†¡
                        WS-->>Frontend: ë¶„ì„ ì§„í–‰ë¥ 

                        Analysis->>Kafka: ê°œë³„ ê°ì • ì¹´ë“œ ê²°ê³¼
                        Kafka->>API: ì¹´ë“œ ë°ì´í„° ìˆ˜ì‹ 
                        API->>Cache: ì¹´ë“œ ë°ì´í„° ì„ì‹œ ì €ì¥
                        API->>WS: ì‹¤ì‹œê°„ ì¹´ë“œ ì „ì†¡
                        WS-->>Frontend: ê°ì • ì¹´ë“œ í‘œì‹œ
                        end

                        Analysis->>DB: ìµœì¢… ë¶„ì„ ê²°ê³¼ ì €ì¥
                        Analysis->>Kafka: ë¶„ì„ ì™„ë£Œ ì•Œë¦¼
                        Kafka->>API: ì™„ë£Œ ë©”ì‹œì§€ ìˆ˜ì‹ 
                        API->>WS: ë¶„ì„ ì™„ë£Œ ì•Œë¦¼
                        WS-->>Frontend: ê²°ê³¼ í˜ì´ì§€ë¡œ ì´ë™

                        Frontend->>API: GET /api/analysis/{id}/results
                        API->>DB: ë¶„ì„ ê²°ê³¼ ì¡°íšŒ
                        API->>Cache: ê²°ê³¼ ìºì‹±
                        API-->>Frontend: ë¶„ì„ ê²°ê³¼ ë°˜í™˜
                    </div>
                </div>
            </div>

            <!-- ë„¤íŠ¸ì›Œí¬ ë³´ì•ˆ -->
            <div id="security" class="diagram-section">
                <h2>ğŸ›¡ï¸ ë„¤íŠ¸ì›Œí¬ ë³´ì•ˆ</h2>
                <div class="description">
                    <h3>ë‹¤ì¸µ ë³´ì•ˆ ì•„í‚¤í…ì²˜</h3>
                    <p>VPC, ì„œë¸Œë„·, ë³´ì•ˆ ê·¸ë£¹, ë„¤íŠ¸ì›Œí¬ ì •ì±…ì„ í†µí•œ ë‹¤ì¸µ ë³´ì•ˆ êµ¬ì¡°ë¡œ ì‹œìŠ¤í…œì„ ë³´í˜¸í•©ë‹ˆë‹¤.</p>
                </div>
                <div class="features">
                    <div class="feature">
                        <h4>ğŸŒ Public/Private ë¶„ë¦¬</h4>
                        <p>ì¸í„°ë„· ì ‘ê·¼ì´ í•„ìš”í•œ ì„œë¹„ìŠ¤ë§Œ Public ì„œë¸Œë„·ì— ë°°ì¹˜</p>
                    </div>
                    <div class="feature">
                        <h4>ğŸ›¡ï¸ Security Groups</h4>
                        <p>ì¸ìŠ¤í„´ìŠ¤ ë ˆë²¨ ë°©í™”ë²½ìœ¼ë¡œ í¬íŠ¸ ê¸°ë°˜ ì ‘ê·¼ ì œì–´</p>
                    </div>
                    <div class="feature">
                        <h4>ğŸ” Network Policies</h4>
                        <p>Kubernetes ë„¤íŠ¸ì›Œí¬ ì •ì±…ìœ¼ë¡œ Pod ê°„ í†µì‹  ì œì–´</p>
                    </div>
                    <div class="feature">
                        <h4>ğŸšª NAT Gateway</h4>
                        <p>Private ì„œë¸Œë„·ì˜ ì•ˆì „í•œ ì•„ì›ƒë°”ìš´ë“œ ì¸í„°ë„· ì ‘ê·¼</p>
                    </div>
                </div>
                <div class="diagram-container">
                    <div class="mermaid">
                        graph TB
                        subgraph Internet["ğŸŒ ì¸í„°ë„·"]
                        Users[ğŸ‘¥ ì‚¬ìš©ìë“¤]
                        end

                        subgraph AWS["â˜ï¸ AWS VPC"]
                        subgraph PublicSubnet["ğŸŒ Public Subnet"]
                        IGW[ğŸšª Internet Gateway]
                        ALB[âš–ï¸ Application Load Balancer<br />443 80]
                        NAT[ğŸšª NAT Gateway]
                        end

                        subgraph PrivateSubnet1["ğŸ”’ Private Subnet AZ-1a"]
                        subgraph EKSNodes1["â˜¸ï¸ EKS Worker Nodes"]
                        WebPods1[ğŸ“± Web Tier Pods<br />Port: 3000 80]
                        AppPods1[ğŸ”§ App Tier Pods<br />Port: 8000 8080]
                        end
                        end

                        subgraph PrivateSubnet2["ğŸ”’ Private Subnet AZ-1b"]
                        subgraph EKSNodes2["â˜¸ï¸ EKS Worker Nodes"]
                        DataPods2[ğŸ’¾ Data Tier Pods<br />Port: 9092 6379 5432]
                        PipelinePods2[ğŸ”„ Pipeline Pods<br />Port: 8002 8003]
                        end
                        end

                        subgraph DatabaseSubnet["ğŸ—„ï¸ Database Subnet"]
                        RDS[ğŸ˜ RDS PostgreSQL<br />Port: 5432]
                        end
                        end

                        %% Network flows
                        Users -->|HTTPS:443| IGW
                        IGW --> ALB
                        ALB -->|HTTP:80| WebPods1
                        WebPods1 -->|HTTP:8000| AppPods1
                        AppPods1 -->|TCP:9092| DataPods2
                        AppPods1 -->|TCP:6379| DataPods2
                        AppPods1 -->|TCP:5432| RDS

                        %% Outbound internet access
                        AppPods1 --> NAT
                        DataPods2 --> NAT
                        PipelinePods2 --> NAT
                        NAT --> IGW

                        %% Security Groups
                        subgraph SecurityGroups["ğŸ›¡ï¸ Security Groups"]
                        ALBSG[ALB-SG<br />Inbound: 80 443 from 0.0.0.0/0<br />Outbound: 3000 8000 to EKS-SG]
                        EKSSG[EKS-SG<br />Inbound: 3000 8000 from ALB-SG<br />Inbound: 9092 6379 from
                        EKS-SG<br />Outbound: All to 0.0.0.0/0]
                        RDSSG[RDS-SG<br />Inbound: 5432 from EKS-SG<br />Outbound: None]
                        end

                        %% Network Policies
                        subgraph NetworkPolicies["ğŸ” Network Policies"]
                        WebPolicy[Web Tier Policy<br />Allow: Ingress from ALB<br />Allow: Egress to App Tier]
                        AppPolicy[App Tier Policy<br />Allow: Ingress from Web Tier<br />Allow: Egress to Data Tier]
                        DataPolicy[Data Tier Policy<br />Allow: Ingress from App/Pipeline Tier<br />Deny: Direct
                        external access]
                        end

                        classDef public fill:#FF9800,stroke:#fff,stroke-width:2px,color:#fff
                        classDef private fill:#4CAF50,stroke:#fff,stroke-width:2px,color:#fff
                        classDef database fill:#2196F3,stroke:#fff,stroke-width:2px,color:#fff
                        classDef security fill:#F44336,stroke:#fff,stroke-width:2px,color:#fff

                        class PublicSubnet,IGW,ALB,NAT public
                        class PrivateSubnet1,PrivateSubnet2,EKSNodes1,EKSNodes2 private
                        class DatabaseSubnet,RDS database
                        class SecurityGroups,NetworkPolicies,ALBSG,EKSSG,RDSSG security
                    </div>
                </div>
            </div>

            <!-- Auto Scaling -->
            <div id="scaling" class="diagram-section">
                <h2>ğŸ“ˆ Auto Scaling ì „ëµ</h2>
                <div class="description">
                    <h3>ë‹¤ì°¨ì› ìë™ í™•ì¥</h3>
                    <p>HPA, VPA, Cluster Autoscaler, ì»¤ìŠ¤í…€ ìŠ¤ì¼€ì¼ë§ì„ ì¡°í•©í•˜ì—¬ ìµœì ì˜ ë¦¬ì†ŒìŠ¤ í™œìš©ê³¼ ë¹„ìš© íš¨ìœ¨ì„±ì„ ë‹¬ì„±í•©ë‹ˆë‹¤.</p>
                </div>
                <div class="features">
                    <div class="feature">
                        <h4>ğŸ”„ HPA (Horizontal Pod Autoscaler)</h4>
                        <p>CPU/Memory ì‚¬ìš©ë¥  ê¸°ë°˜ Pod ìˆ˜ ìë™ ì¡°ì ˆ</p>
                    </div>
                    <div class="feature">
                        <h4>ğŸ“Š VPA (Vertical Pod Autoscaler)</h4>
                        <p>Podì˜ ë¦¬ì†ŒìŠ¤ ìš”ì²­ëŸ‰ ìë™ ìµœì í™”</p>
                    </div>
                    <div class="feature">
                        <h4>ğŸ—ï¸ Cluster Autoscaler</h4>
                        <p>ì›Œí¬ë¡œë“œì— ë”°ë¥¸ ë…¸ë“œ ìë™ í™•ì¥/ì¶•ì†Œ</p>
                    </div>
                    <div class="feature">
                        <h4>âš™ï¸ Custom Scaling</h4>
                        <p>Kafka í ê¹Šì´, ì‹œê°„ëŒ€ë³„ ì˜ˆì¸¡ ìŠ¤ì¼€ì¼ë§</p>
                    </div>
                </div>
                <div class="diagram-container">
                    <div class="mermaid">
                        graph TB
                        subgraph Scaling["ğŸ“ˆ Auto Scaling ì „ëµ"]
                        subgraph HPA["ğŸ”„ Horizontal Pod Autoscaler"]
                        BackendHPA[ğŸ–¥ï¸ Backend API HPA<br />Min: 3 Max: 20<br />CPU: 70% Memory: 80%]
                        WebSocketHPA[ğŸ”Œ WebSocket HPA<br />Min: 2 Max: 10<br />CPU: 60% Memory: 70%]
                        CrawlerHPA[ğŸ•·ï¸ Crawler HPA<br />Min: 2 Max: 8<br />CPU: 80% Memory: 85%]
                        AnalysisHPA[ğŸ§  Analysis HPA<br />Min: 1 Max: 5<br />GPU: 70% Memory: 80%]
                        end

                        subgraph VPA["ğŸ“Š Vertical Pod Autoscaler"]
                        BackendVPA[ğŸ–¥ï¸ Backend VPA<br />CPU: 500m-2000m<br />Memory: 512Mi-2Gi]
                        KafkaVPA[ğŸ“¨ Kafka VPA<br />CPU: 1000m-4000m<br />Memory: 1Gi-4Gi]
                        RedisVPA[ğŸ”´ Redis VPA<br />CPU: 250m-1000m<br />Memory: 256Mi-1Gi]
                        end

                        subgraph ClusterAS["ğŸ—ï¸ Cluster Autoscaler"]
                        GeneralAS[ğŸ’» General Nodes<br />Min: 2 Max: 10<br />Scale on: Pod pending]
                        GPUAS[ğŸ® GPU Nodes<br />Min: 0 Max: 5<br />Scale on: GPU requests]
                        SpotAS[ğŸ’° Spot Nodes<br />Min: 1 Max: 15<br />Scale on: Batch workloads]
                        end

                        subgraph CustomScaling["âš™ï¸ Custom Scaling"]
                        KafkaScaling[ğŸ“¨ Kafka Consumer Lag<br />Scale crawlers based on<br />message queue depth]
                        TimeBasedScaling[â° Time-based Scaling<br />Scale up during peak hours<br />8AM-10PM KST]
                        PredictiveScaling[ğŸ”® Predictive Scaling<br />ML-based scaling<br />based on historical patterns]
                        end
                        end

                        %% Scaling triggers
                        BackendHPA -->|High CPU/Memory| GeneralAS
                        AnalysisHPA -->|GPU requests| GPUAS
                        CrawlerHPA -->|Batch jobs| SpotAS

                        KafkaScaling -->|Queue depth > 1000| CrawlerHPA
                        TimeBasedScaling -->|Peak hours| BackendHPA
                        PredictiveScaling -->|Traffic prediction| GeneralAS

                        classDef hpa fill:#4CAF50,stroke:#fff,stroke-width:2px,color:#fff
                        classDef vpa fill:#2196F3,stroke:#fff,stroke-width:2px,color:#fff
                        classDef cluster fill:#FF9800,stroke:#fff,stroke-width:2px,color:#fff
                        classDef custom fill:#9C27B0,stroke:#fff,stroke-width:2px,color:#fff

                        class BackendHPA,WebSocketHPA,CrawlerHPA,AnalysisHPA hpa
                        class BackendVPA,KafkaVPA,RedisVPA vpa
                        class GeneralAS,GPUAS,SpotAS cluster
                        class KafkaScaling,TimeBasedScaling,PredictiveScaling custom
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Mermaid ì´ˆê¸°í™”
        mermaid.initialize({
            startOnLoad: true,
            theme: 'default',
            securityLevel: 'loose',
            fontFamily: 'Arial, sans-serif',
            fontSize: 16,
            flowchart: {
                useMaxWidth: false,
                htmlLabels: true,
                curve: 'basis',
                padding: 20
            },
            sequence: {
                diagramMarginX: 50,
                diagramMarginY: 10,
                actorMargin: 50,
                width: 180,
                height: 80,
                boxMargin: 10,
                boxTextMargin: 5,
                noteMargin: 10,
                messageMargin: 35,
                mirrorActors: true,
                bottomMarginAdj: 1,
                useMaxWidth: false,
                rightAngles: false,
                showSequenceNumbers: false
            },
            gantt: {
                useMaxWidth: false
            },
            journey: {
                useMaxWidth: false
            }
        });

        // ë‹¤ì´ì–´ê·¸ë¨ ì „í™˜ í•¨ìˆ˜
        function showDiagram(diagramId) {
            // ëª¨ë“  ì„¹ì…˜ ìˆ¨ê¸°ê¸°
            const sections = document.querySelectorAll('.diagram-section');
            sections.forEach(section => {
                section.classList.remove('active');
            });

            // ëª¨ë“  ë²„íŠ¼ ë¹„í™œì„±í™”
            const buttons = document.querySelectorAll('.nav-btn');
            buttons.forEach(btn => {
                btn.classList.remove('active');
            });

            // ì„ íƒëœ ì„¹ì…˜ í‘œì‹œ
            const targetSection = document.getElementById(diagramId);
            if (targetSection) {
                targetSection.classList.add('active');
            }

            // ì„ íƒëœ ë²„íŠ¼ í™œì„±í™”
            const targetButton = event.target;
            targetButton.classList.add('active');

            // í˜ì´ì§€ ìƒë‹¨ìœ¼ë¡œ ìŠ¤í¬ë¡¤
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        // í˜ì´ì§€ ë¡œë“œ ì™„ë£Œ í›„ Mermaid ë‹¤ì‹œ ë Œë”ë§
        window.addEventListener('load', function () {
            setTimeout(() => {
                mermaid.init();
            }, 100);
        });

        // ë°˜ì‘í˜• ì²˜ë¦¬
        window.addEventListener('resize', function () {
            // ë‹¤ì´ì–´ê·¸ë¨ í¬ê¸° ì¡°ì •
            const diagrams = document.querySelectorAll('.mermaid');
            diagrams.forEach(diagram => {
                if (diagram.getAttribute('data-processed') === 'true') {
                    // ì´ë¯¸ ì²˜ë¦¬ëœ ë‹¤ì´ì–´ê·¸ë¨ ì¬ë Œë”ë§
                    const svg = diagram.querySelector('svg');
                    if (svg) {
                        svg.style.maxWidth = '100%';
                        svg.style.height = 'auto';
                    }
                }
            });
        });
    </script>
</body>

</html>